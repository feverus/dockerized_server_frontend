asyncapi: 3.0.0
info:
  title: БЯМ WebSocket API
  version: 1.0.0
  description: |
    Этот API предоставляет потоковый доступ к БЯМ через WebSocket.

servers:
  production:
    host: localhost:8002
    pathname: /ai/ws/chat
    protocol: ws

channels:
  chat:
    address: /ai/ws/chat
    description: Единый канал для двунаправленного общения.
    messages:
      sentMessage:
        $ref: "./features/messages/sentMessage.yml"
      receivedMessage:
        $ref: "./features/messages/receivedMessage.yml"

operations:
  sendUserMessage:
    action: send
    channel:
      $ref: "#/channels/chat"
    messages:
      - $ref: "#/channels/chat/messages/sentMessage"
  receiveServerMessage:
    action: receive
    channel:
      $ref: "#/channels/chat"
    messages:
      - $ref: "#/channels/chat/messages/receivedMessage"

# Эта секция нужна для того, чтобы инструменты могли найти определения
# при парсинге, даже если они используются только в каналах.
components:
  messages:
    sentMessage:
      $ref: "./features/messages/sentMessage.yml"
    receivedMessage:
      $ref: "./features/messages/receivedMessage.yml"